{% extends "base.html" %}
{% load staticfiles %}
{% load render_table from django_tables2 %}
{% block extracss %}
    <link href="{% static "css/table.css" %}" rel="stylesheet">
{% endblock %}
{% block content %}
<div class="main-content">
<div id="layoutSidenav_content">
    <main>
    <div class="container-fluid px-4">
    <h1 class="mt-4">Visits by Country</h1>
    <div class="row">
                            <div class="col-xl-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <i class="fas fa-chart-area me-1"></i>
                                        Chart
                                    </div>
                                    <div class="card-body"><canvas id="chart_div" width="100%" height="40"></canvas></div>
                                </div>
                            </div>
                            <div class="col-xl-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <i class="fas fa-chart-bar me-1"></i> Map
                                    </div>
                                    <div class="card-body"><canvas id="myBarChart" width="100%" height="40"></canvas></div>
                                </div>
                            </div>
                        </div>
    <div class="card mb-4">
    <div class="card-header">
        <i class="fas fa-table me-1"></i>
                                Visits by Country Excluding SA
                                <div id="order-list-buttonset" class="btn-group pull-right">
                                    <button onclick='location="?pdf"' class="btn btn-primary" id="download-btn"> <i class="icon-download"></i> Download as PDF</button>
                                    <button onclick='location="{% url 'visitorMonthlyReport' myCurrentMonth|date:'Y' myCurrentMonth|date:'m' %}"' class="btn" id="monthly-reports-btn"><i class="icon-calendar"></i> View Monthly Reports</button>                                </div>
                            </div>
    <div class="card-body">
        {% if table %}
            {% render_table table 'django_tables2/custom-table.html' %}
        {% else %}
            <div class="row-fluid center">
                <h2>No Report to Generate</h2>
            </div>
            </div>
            </div>
            </div>
            </main>
            </div>
            </div>

  {% endif %}
{% endblock %}
{% block footer %}
    <script src="{% static "js/libs/jquery/jquery-3.6.0.min.js" %}"></script>
    <script src="{% static "js/libs/highcharts/highcharts.js" %}"></script>
    <script src="{% static "js/libs/highcharts/modules/data.js" %}"></script>
    <script src="{% static "js/libs/highcharts/modules/exporting.js" %}"></script>
    <script src="{% static "js/libs/highcharts/modules/export-data.js" %}"></script>
    <script src="{% static "js/libs/highcharts/modules/accessibility.js" %}"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            const chart = new Highcharts.Chart({
            chart: {
                renderTo: 'chart_div',
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
                type: 'pie'
            },
                plotOptions: {
        pie: {
            allowPointSelect: true,
            cursor: 'pointer',
            dataLabels: {
                enabled: false
            },
            showInLegend: true
        }
    },
            title: {
                text: '',
            },
            xAxis: {
                type: 'datetime',
                title: {
                    text: 'Date'
                },
                labels: {
                    formatter: function () {
                        return Highcharts.dateFormat('%b %y', this.value)
                    },
                }
            },
            yAxis: {
                title: {
                    text: 'Water Temperature (Â°C)'
                }
            },
            legend: {
                layout: 'horizontal',
                enabled: true,
                verticalAlign: 'top'
            },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ["printChart",
                            "separator",
                            "downloadPNG",
                            "downloadJPEG",
                            "downloadPDF",
                            "downloadSVG",
                            "separator",
                            "downloadCSV",
                            "downloadXLS"]
                    }
                }
            },
            series: [{
        name: 'Brands',
        colorByPoint: true,
        data: [{
            name: 'Chrome',
            y: 61.41,
            sliced: true,
            selected: true
        }, {
            name: 'Internet Explorer',
            y: 11.84
        }, {
            name: 'Firefox',
            y: 10.85
        }, {
            name: 'Edge',
            y: 4.67
        }, {
            name: 'Safari',
            y: 4.18
        }, {
            name: 'Other',
            y: 7.05
        }]
    }]
        });

        })
            {#var chart = {#}
            {#   plotBackgroundColor: null,#}
            {#   plotBorderWidth: null,#}
            {#   plotShadow: false#}
        {#    var title = {#}
        {#       text: 'Browser market shares at a specific website, 2014'#}
        {#    };#}
        {#    var tooltip = {#}
        {#       pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'#}
        {#    };#}
        {#    var plotOptions = {#}
        {#       pie: {#}
        {#          allowPointSelect: true,#}
        {#          cursor: 'pointer',#}
        {##}
        {#          dataLabels: {#}
        {#             enabled: false#}
        {#          },#}
        {##}
        {#          showInLegend: true#}
        {#       }#}
        {#    };#}
        {#    var series = [{#}
        {#       type: 'pie',#}
        {#       name: 'Browser share',#}
        {#       data: [#}
        {#          ['Firefox',   45.0],#}
        {#          ['IE',       26.8],#}
        {#          {#}
        {#             name: 'Chrome',#}
        {#             y: 12.8,#}
        {#             sliced: true,#}
        {#             selected: true#}
        {#          },#}
        {#          ['Safari',    8.5],#}
        {#          ['Opera',     6.2],#}
        {#          ['Others',   0.7]#}
        {#       ]#}
        {#    }];#}
        {#    var json = {};#}
        {#    json.chart = chart;#}
        {#    json.title = title;#}
        {#    json.tooltip = tooltip;#}
        {#    json.series = series;#}
        {#    json.plotOptions = plotOptions;#}
        {#    $('#chart_div').highcharts(json);#}
        {# });#}
        {##}
        {#// Load the Visualization API and the piechart package.#}
        {#google.load('visualization', '1', {'packages':['corechart']});#}
        {#// Set a callback to run when the Google Visualization API is loaded.#}
        {#google.setOnLoadCallback(drawChart);#}
        {#// Callback that creates and populates a data table,#}
        {#// instantiates the pie chart, passes in the data and#}
        {#// draws it.#}
        {#function drawChart() {#}
        {##}
        {#// Create our data table.#}
        {#var data = new google.visualization.DataTable();#}
        {#data.addColumn('string', 'Country');#}
        {#data.addColumn('number', 'Visits');#}
        {#data.addRows([#}
        {#  {% for myCountry in myScores %}#}
        {#  {% ifnotequal myCountry.country 'south africa' %}#}
        {#  ['{{myCountry.country|title}}', {{ myCountry.count }}],#}
        {#  {% endifnotequal %}#}
        {#  {% endfor %}#}
        {#  [null,null]]);#}

        {#  // Instantiate and draw our chart, passing in some options.#}
        {#  var chart = new google.visualization.PieChart(document.getElementById('chart_div'));#}
        {#  chart.draw(data, {height: 300, is3D: true, backgroundColor:'transparent'});#}
</script>
{% endblock %}
