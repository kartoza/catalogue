{# Original code from Tim's SABIO project and copyright is retained by the original author #}
{% load url from future %} {# https://docs.djangoproject.com/en/1.4/releases/1.3/#changes-to-url-and-ssi #}
{% block content %}
<script type="text/javascript">
function showTask(theId) {
  theUrl = '/viewtaskingrequest/' + theId + '/';
  $('#main-content').load(theUrl,'', zebraTables );
};
</script>
<div class="row-fluid">
  <h2 class="centered">Tasking Requests List</h2>
</div>

<div class="row-fluid center">
  <form name="frmShowTask" method="get" action="" class="form-horizontal">
    <label for="task_id_text">Go to Tasking Request:</label>
    <div class="input-append">
      <input name="task_id_text" type="text" size="6" maxlength="5" />
      <input type="submit" class="btn btn-success" value="Go!" onclick="showTask(forms['frmShowTask'].task_id_text.value); return false;">
    </div>
  </form>
</div>

<div class="row-fluid center gap-bottom">
  {% if user.is_staff %}
  <button id="product-orders-view-btn" onclick='location="{% url 'listOrders' %}"' class="btn btn-small"><i class="icon-refresh"></i> Switch to orders View</button>
  {% endif %}
  <div class="btn-group">
    {% if myRecords.has_previous %}
      <button href="{{myUrl}}?page={{ myRecords.previous_page_number }}" class="btn btn-small"><i class="icon-backward"></i></button>
    {% endif %}
    <button class="btn btn-small disabled btn-success">{{ myRecords.number }} of {{ myRecords.paginator.num_pages }}</button>
    {% if myRecords.has_next %}
      <button href="{{myUrl}}?page={{ myRecords.next_page_number }}" class="btn btn-small"><i class="icon-forward"></i></button>
    {% endif %}
  </div>
</div>

<div class="row-fluid">
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Id</th>
        <th>Date</th>
        <th>Status</th>
        <th>Placed by</th>
        <th class="center">View Details</th>
      </tr>
    </thead>
    <tbody>
      {% for myOrder in myRecords.object_list %}
      <tr>
        <td>{{myOrder.id }}</td>
        <td>{{myOrder.order_date|date:"D, d M Y, H:m" }}</td>
        <td>{{myOrder.order_status}}</td>
        <td>{{myOrder.user.first_name}} {{myOrder.user.last_name}}</td>
        <td class="center">
          <a href="Javascript:void(0);" onclick='$("#main-content").load("{% url 'viewTaskingRequest' myOrder.id %}","", zebraTables ); return false;'>
            <i class="icon-search"></i>
          </a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <div class="row-fluid center gap-bottom">
    <div class="btn-group">
      {% if myRecords.has_previous %}
        <button href="{{myUrl}}?page={{ myRecords.previous_page_number }}" class="btn btn-small"><i class="icon-backward"></i></button>
      {% endif %}
      <button class="btn btn-small disabled btn-success">{{ myRecords.number }} of {{ myRecords.paginator.num_pages }}</button>
      {% if myRecords.has_next %}
        <button href="{{myUrl}}?page={{ myRecords.next_page_number }}" class="btn btn-small"><i class="icon-forward"></i></button>
      {% endif %}
    </div>
  </div>
</div>
<script>
$('#product-orders-view-btn').popover({
  placement:'left',
  trigger:'hover',
  content:'Click to switch to the Product Orders View',
  title:'Product Orders View'
});
</script>
{% endblock %}
