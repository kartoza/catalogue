

% Leave the two blank lines above

== Catalogue Reporting tools ==

The catalogue provides numerous interactions for users and is continually being
updated with new metadata records. It is useful to produce reports that allow
SANSA staff to obtain the pulse of the system. These reports cover 4 main
areas:

+ Data holdings
+ Search activities
+ Visitor statistics
+ Order and tasking activities
+

The reports can be obtained in one of two ways:

+ Visiting the 'staff' area of the web site and selecting from the reports
  presented there
+ By direct email. Here staff can nominate which reports they wish to receive,
  and with which frequency they receive them
+

**Note:** Only 'staff' members are elegible to receive reports.

Reports sent by email will be in either rich html format, or as pdf attachments.

=== Order summaries ===

==== Order summary table ====

The order summary table is accessible from the **Staff -> Orders list** and for
individual users from **Popular Links -> My orders**. For individual users,
only their own orders will be listed. In all other respects, both tables are
the same. The table contains the following headers:

|| Id | Date | Status | Placed by | View |

When clicked, the headers will set the sort order for the table.

Above the table is a chart which displays total orders by status. For
individual users, this chart shows only their own orders.

The summary report link on the summary table will return the user an on-the-fly
created order summary report in pdf format as described below.

==== Order summary report ====

The order summary report will be sent to nominated users at chose interval of
daily, weekly or monthly. It can also be generated on-the-fly from the staff 
admin interface.

The orders summary report contains the following information:

- How many orders have been created in the reporting month
- How many orders have been closed in the reporting month
- A break down of all open orders by status (accepted etc.)
- A break down of all open orders by age
- A break down of all orders by customer
-

Format : pdf

=== PDF report generation ===

To generate on-the-fly PDF reports we use **Pisa**
http://www.xhtml2pdf.com which is an HTML/XHTML/CSS to PDF converter
written in Python and based on Reportlab Toolkit, pyPDF, TechGame
Networks CSS Library and HTML5lib. This apporach doesn't break normal
Django application development, as we can use Django Templating engine
to prepare HTML for PDF rendering.

Graphs in PDF reports are created using Google Chart API through
**pygooglechart** Python library.

=== Heatmap preparation ===

Heatmap is based on a pre-calculated data which allows offline map
generation for specific period of time, i.e. last week, last month,
last year, etc.

It's based on discovering intersections of user area of interest
geometry for each search, with quarter degree grid for the whole
world. These intersections are then summarized for each //grid cell//
per day.

Heatmap data and rendering is updated by a scheduled background
process, which creates required heatmaps.

**Note:** Heatmap visualization can be implemented as OpenLayers Image
  layer, or as Mapserver WMS layer



