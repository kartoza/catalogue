{# Original code from Tim's SABIO project and copyright is retained by the original author #}
{% load url from future %} {# https://docs.djangoproject.com/en/1.4/releases/1.3/#changes-to-url-and-ssi #}
<script type="text/javascript">
function showOrder(theId) {
  theUrl = '/vieworder/' + theId + '/';
  $('#content').load(theUrl,'', zebraTables );
};
</script>
{% block content %}
<div class="row-fluid">
  <h2>Orders List</h2>
</div>
<div class="row-fluid">
  <form name="frmShowOrder" method="get" action="" class="span6">
    <fieldset>
      <legend>Search Orders</legend>
      <label>Go to order:</label>
      <div class="input-append">
        <input name="order_id_text" type="text" size="6" maxlength="5" placeholder="Enter Order ID"/>
        <button class="btn" onclick="showOrder(forms['frmShowOrder'].order_id_text.value); return false;">Go!</button>
      </div>
    </fieldset>
  </form>
</div>
<div class="row-fluid center" id="order-list-buttonset">
  <button class="btn" onclick='location="{{ myUrl }}?page={{ myRecords.number}}&pdf"'><i class="icon-download"></i> Download as PDF</button>
  {% if myUrl = '/listorders/' %} {# can't used url template tag for if evaluation #}
  <button class="btn" onclick='location="{% url 'orderMonthlyReport' myCurrentMonth|date:'Y'  myCurrentMonth|date:'m' %}"'>Monthly Reports</button>
  <button class="btn" onclick='location="{% url 'ordersSummary' %}"'>Orders Summary</button>
  {% endif %}
</div>
<table class="table table-striped">
  <thead>
    <th>Id</th>
    <th>Date</th>
    <th>Status</th>
    <th>Placed by</th>
    <th>View</th>
  </thead>
  <tbody>
    <tr>
      <td colspan="5" style="text-align: center;">
        <div class="pagination">
          <span class="step-links">
            <p>
              <button class="btn" onclick='location="{% url 'listTaskingRequests' %}"'>Switch to Tasking Request View</button>
              {% if myRecords.has_previous %}
              <button onclick='$("#content").load("{{myUrl}}?page={{ myRecords.previous_page_number }}","",zebraTables)'>Previous</button>
              {% endif %}
            </p>
            <span class="current">
              <p>Page {{ myRecords.number }} of {{ myRecords.paginator.num_pages }}.</p>
            </span>

            {% if myRecords.has_next %}
            <button onclick='$("#content").load("{{myUrl}}?page={{ myRecords.next_page_number }}","",zebraTables)'>Next</button>
            {% endif %}
          </span>
        </div>
      </td>
    </tr>
    {% for myOrder in myRecords.object_list %}
    <tr>
      <td>{{myOrder.id }}</td>
      <td>{{myOrder.order_date|date:"D, d M Y, H:m" }}</td>
      <td>{{myOrder.order_status}}</td>
      <td>{{myOrder.user.get_profile.firstname}} {{myOrder.user.get_profile.surname}}</td>
      <td>
        <a href="#" onclick='$("#content").load("{% url 'viewOrder' myOrder.id %}","", zebraTables );return false;'>
          <i class="icon-search"></i>
        </a>
      </td>
    </tr>
    {% endfor %}
    <tr>
      <td colspan="5" style="text-align: center;">
        <div class="pagination">
          <span class="step-links">
            {% if myRecords.has_previous %}
            <button onclick='$("#content").load("{{myUrl}}?page={{ myRecords.previous_page_number }}","",zebraTables)'>Previous</button>
            {% endif %}

            <span class="current">
              Page {{ myRecords.number }} of {{ myRecords.paginator.num_pages }}.
            </span>

            {% if myRecords.has_next %}
            <button onclick='$("#content").load("{{myUrl}}?page={{ myRecords.next_page_number }}","",zebraTables)'>Next</button>
            {% endif %}
          </span>
        </div>
      </td>
    </tr>
  </tbody>
</table>
{% endblock %}
